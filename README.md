# File Shredder

PowerShell script for shredding files.

If you have more than enough free disk space, your files will most likely still be recoverable - even after shredding.

Tested with PowerShell v5.1.18362.752 on Windows 10 Enterprise OS (64-bit).

Made for educational purposes. I hope it will help!

## How to Run

Open the PowerShell from [\\src\\](https://github.com/ivan-sincek/file-shredder/tree/master/src) and run the commands shown below.

Set the execution policy:

```pwsh
Set-ExecutionPolicy Unrestricted
```

Run the script:

```pwsh
.\file_shredder.ps1 .\somefile.txt
```

Or, run the following command from either PowerShell or Command Prompt:

```pwsh
PowerShell -ExecutionPolicy Unrestricted -File .\file_shredder.ps1 .\somefile.txt
```

To run the PowerShell encoded command, run the following command from either PowerShell or Command Prompt:

```pwsh
PowerShell -ExecutionPolicy Unrestricted -EncodedCommand JABwACAAPQAgACQAKABSAGUAYQBkAC0ASABvAHMAdAAgAC0AUAByAG8AbQBwAHQAIAAiAEUAbgB0AGUAcgAgAGYAaQBsAGUAIABwAGEAdABoACIAKQAuAFQAcgBpAG0AKAApADsAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAIgAiADsAIABpAGYAIAAoACQAcAAuAEwAZQBuAGcAdABoACAALQBsAHQAIAAxACkAIAB7ACAAVwByAGkAdABlAC0ASABvAHMAdAAgACIARgBpAGwAZQAgAGkAcwAgAHIAZQBxAHUAaQByAGUAZAAiADsAIAB9ACAAZQBsAHMAZQAgAHsAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAIgAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAYABuACMAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIwBgAG4AIwAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAARgBpAGwAZQAgAFMAaAByAGUAZABkAGUAcgAgADEALgAyACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAjAGAAbgAjACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHkAIABJAHYAYQBuACAAUwBpAG4AYwBlAGsAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACMAYABuACMAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIwBgAG4AIwAgAEcAaQB0AEgAdQBiACAAcgBlAHAAbwBzAGkAdABvAHIAeQAgAGEAdAAgAGcAaQB0AGgAdQBiAC4AYwBvAG0ALwBpAHYAYQBuAC0AcwBpAG4AYwBlAGsALwBmAGkAbABlAC0AcwBoAHIAZQBkAGQAZQByAC4AIAAgACAAIAAgACAAIAAgACAAIAAjAGAAbgAjACAARgBlAGUAbAAgAGYAcgBlAGUAIAB0AG8AIABkAG8AbgBhAHQAZQAgAGIAaQB0AGMAbwBpAG4AIABhAHQAIAAxAEIAcgBaAE0ANgBUADcARwA5AFIATgA4AHYAYgBhAGIAbgBmAFgAdQA0AE0ANgBMAHAAZwB6AHQAcQA2AFkAMQA0AC4AIAAgACMAYABuACMAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIwBgAG4AIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACIAOwAgACQAcwB6ACAAPQAgADIAMAA0ADgAOwAgACQAYgAgAD0AIAAkAG4AdQBsAGwAOwAgACQAcgBuAGcAIAA9ACAAJABuAHUAbABsADsAIAAkAHMAIAA9ACAAJABuAHUAbABsADsAIAAkAGYAIAA9ACAAJABuAHUAbABsADsAIAB0AHIAeQAgAHsAIAAkAGYAIAA9ACAARwBlAHQALQBJAHQAZQBtACAAJABwACAALQBFAHIAcgBvAHIAQQBjAHQAaQBvAG4AIABTAGkAbABlAG4AdABsAHkAQwBvAG4AdABpAG4AdQBlADsAIABpAGYAIAAoACQAZgAgAC0AZQBxACAAJABuAHUAbABsACkAIAB7ACAAVwByAGkAdABlAC0ASABvAHMAdAAgACIAUABhAHQAaAAgAGQAbwBlAHMAIABuAG8AdAAgAGUAeABpAHMAdABzACIAOwAgAH0AIABlAGwAcwBlAGkAZgAgACgAJABmACAALQBpAHMAbgBvAHQAIABbAEkATwAuAEYAaQBsAGUASQBuAGYAbwBdACkAIAB7ACAAVwByAGkAdABlAC0ASABvAHMAdAAgACIAUABhAHQAaAAgAHMAcABlAGMAaQBmAGkAZQBkACAAaQBzACAAbgBvAHQAIABhACAAZgBpAGwAZQAiADsAIAB9ACAAZQBsAHMAZQAgAHsAIAAkAGYALgBBAHQAdAByAGkAYgB1AHQAZQBzACAAPQAgACIATgBvAHIAbQBhAGwAIgA7ACAAJABzAGUAYwAgAD0AIABbAE0AYQB0AGgAXQA6ADoAQwBlAGkAbABpAG4AZwAoACQAZgAuAEwAZQBuAGcAdABoACAALwAgACQAcwB6ACkAOwAgACQAcwAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAASQBPAC4ARgBpAGwAZQBTAHQAcgBlAGEAbQAoACQAZgAuAEYAdQBsAGwATgBhAG0AZQAsACAAWwBJAE8ALgBGAGkAbABlAEEAYwBjAGUAcwBzAF0AOgA6AFcAcgBpAHQAZQApADsAIABmAG8AcgAgACgAJABpACAAPQAgADAAOwAgACQAaQAgAC0AbAB0ACAANwA7ACAAJABpACsAKwApACAAewAgACQAcwAuAFAAbwBzAGkAdABpAG8AbgAgAD0AIAAwADsAIABmAG8AcgAgACgAJABqACAAPQAgADAAOwAgACQAagAgAC0AbAB0ACAAJABzAGUAYwA7ACAAJABqACsAKwApACAAewAgACQAYgAgAD0AIABbAFMAZQBjAHUAcgBpAHQAeQAuAEMAcgB5AHAAdABvAGcAcgBhAHAAaAB5AC4AUgBhAG4AZABvAG0ATgB1AG0AYgBlAHIARwBlAG4AZQByAGEAdABvAHIAXQA6ADoARwBlAHQAQgB5AHQAZQBzACgAJABzAHoAKQA7ACAAJABzAC4AVwByAGkAdABlACgAJABiACwAIAAwACwAIAAkAGIALgBMAGUAbgBnAHQAaAApADsAIAB9ACAAfQAgACQAcwAuAFMAZQB0AEwAZQBuAGcAdABoACgAMAApADsAIAAkAHMALgBDAGwAbwBzAGUAKAApADsAIAAkAGYALgBDAHIAZQBhAHQAaQBvAG4AVABpAG0AZQAgAD0AIAAiADAAOQAvADAANgAvADIAMAA2ADkAIAAwADQAOgAyADAAOgAwADAAIABBAE0AIgA7ACAAJABmAC4ATABhAHMAdABXAHIAaQB0AGUAVABpAG0AZQAgAD0AIAAiADAAOQAvADAANgAvADIAMAA2ADkAIAAwADQAOgAyADAAOgAwADAAIABBAE0AIgA7ACAAJABmAC4ATABhAHMAdABBAGMAYwBlAHMAcwBUAGkAbQBlACAAPQAgACIAMAA5AC8AMAA2AC8AMgAwADYAOQAgADAANAA6ADIAMAA6ADAAMAAgAEEATQAiADsAIAAkAGYALgBEAGUAbABlAHQAZQAoACkAOwAgAFcAcgBpAHQAZQAtAEgAbwBzAHQAIAAiAEYAaQBsAGUAIABoAGEAcwAgAGIAZQBlAG4AIABzAGgAcgBlAGQAZABlAGQAIABzAHUAYwBjAGUAcwBzAGYAdQBsAGwAeQAiADsAIAB9ACAAfQAgAGMAYQB0AGMAaAAgAHsAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAJABfAC4ARQB4AGMAZQBwAHQAaQBvAG4ALgBJAG4AbgBlAHIARQB4AGMAZQBwAHQAaQBvAG4ALgBNAGUAcwBzAGEAZwBlADsAIAB9ACAAZgBpAG4AYQBsAGwAeQAgAHsAIABpAGYAIAAoACQAYgAgAC0AbgBlACAAJABuAHUAbABsACkAIAB7ACAAJABiAC4AQwBsAGUAYQByACgAKQA7ACAAfQAgAGkAZgAgACgAJAByAG4AZwAgAC0AbgBlACAAJABuAHUAbABsACkAIAB7ACAAJAByAG4AZwAuAEQAaQBzAHAAbwBzAGUAKAApADsAIAB9ACAAaQBmACAAKAAkAHMAIAAtAG4AZQAgACQAbgB1AGwAbAApACAAewAgACQAcwAuAEMAbABvAHMAZQAoACkAOwAgACQAcwAuAEQAaQBzAHAAbwBzAGUAKAApADsAIAB9ACAAaQBmACAAKAAkAGYAIAAtAG4AZQAgACQAbgB1AGwAbAApACAAewAgAEMAbABlAGEAcgAtAFYAYQByAGkAYQBiAGwAZQAgAC0ATgBhAG0AZQAgACIAZgAiADsAIAB9ACAAfQAgAH0ADQAKAA==
```

The encoded script will prompt for input. See the slightly altered and minified script [here](https://github.com/ivan-sincek/file-shredder/blob/master/src/file_shredder_mini.ps1).

To pass parameters to PowerShell encoded command, run the following command from either PowerShell or Command Prompt:

```pwsh
PowerShell -Command "'.\somefile.txt'" | PowerShell -ExecutionPolicy Unrestricted -EncodedCommand JABwACAAPQAgACQAKABSAGUAYQBkAC0ASABvAHMAdAAgAC0AUAByAG8AbQBwAHQAIAAiAEUAbgB0AGUAcgAgAGYAaQBsAGUAIABwAGEAdABoACIAKQAuAFQAcgBpAG0AKAApADsAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAIgAiADsAIABpAGYAIAAoACQAcAAuAEwAZQBuAGcAdABoACAALQBsAHQAIAAxACkAIAB7ACAAVwByAGkAdABlAC0ASABvAHMAdAAgACIARgBpAGwAZQAgAGkAcwAgAHIAZQBxAHUAaQByAGUAZAAiADsAIAB9ACAAZQBsAHMAZQAgAHsAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAIgAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAYABuACMAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIwBgAG4AIwAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAARgBpAGwAZQAgAFMAaAByAGUAZABkAGUAcgAgADEALgAyACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAjAGAAbgAjACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHkAIABJAHYAYQBuACAAUwBpAG4AYwBlAGsAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACMAYABuACMAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIwBgAG4AIwAgAEcAaQB0AEgAdQBiACAAcgBlAHAAbwBzAGkAdABvAHIAeQAgAGEAdAAgAGcAaQB0AGgAdQBiAC4AYwBvAG0ALwBpAHYAYQBuAC0AcwBpAG4AYwBlAGsALwBmAGkAbABlAC0AcwBoAHIAZQBkAGQAZQByAC4AIAAgACAAIAAgACAAIAAgACAAIAAjAGAAbgAjACAARgBlAGUAbAAgAGYAcgBlAGUAIAB0AG8AIABkAG8AbgBhAHQAZQAgAGIAaQB0AGMAbwBpAG4AIABhAHQAIAAxAEIAcgBaAE0ANgBUADcARwA5AFIATgA4AHYAYgBhAGIAbgBmAFgAdQA0AE0ANgBMAHAAZwB6AHQAcQA2AFkAMQA0AC4AIAAgACMAYABuACMAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIwBgAG4AIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACIAOwAgACQAcwB6ACAAPQAgADIAMAA0ADgAOwAgACQAYgAgAD0AIAAkAG4AdQBsAGwAOwAgACQAcgBuAGcAIAA9ACAAJABuAHUAbABsADsAIAAkAHMAIAA9ACAAJABuAHUAbABsADsAIAAkAGYAIAA9ACAAJABuAHUAbABsADsAIAB0AHIAeQAgAHsAIAAkAGYAIAA9ACAARwBlAHQALQBJAHQAZQBtACAAJABwACAALQBFAHIAcgBvAHIAQQBjAHQAaQBvAG4AIABTAGkAbABlAG4AdABsAHkAQwBvAG4AdABpAG4AdQBlADsAIABpAGYAIAAoACQAZgAgAC0AZQBxACAAJABuAHUAbABsACkAIAB7ACAAVwByAGkAdABlAC0ASABvAHMAdAAgACIAUABhAHQAaAAgAGQAbwBlAHMAIABuAG8AdAAgAGUAeABpAHMAdABzACIAOwAgAH0AIABlAGwAcwBlAGkAZgAgACgAJABmACAALQBpAHMAbgBvAHQAIABbAEkATwAuAEYAaQBsAGUASQBuAGYAbwBdACkAIAB7ACAAVwByAGkAdABlAC0ASABvAHMAdAAgACIAUABhAHQAaAAgAHMAcABlAGMAaQBmAGkAZQBkACAAaQBzACAAbgBvAHQAIABhACAAZgBpAGwAZQAiADsAIAB9ACAAZQBsAHMAZQAgAHsAIAAkAGYALgBBAHQAdAByAGkAYgB1AHQAZQBzACAAPQAgACIATgBvAHIAbQBhAGwAIgA7ACAAJABzAGUAYwAgAD0AIABbAE0AYQB0AGgAXQA6ADoAQwBlAGkAbABpAG4AZwAoACQAZgAuAEwAZQBuAGcAdABoACAALwAgACQAcwB6ACkAOwAgACQAcwAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAASQBPAC4ARgBpAGwAZQBTAHQAcgBlAGEAbQAoACQAZgAuAEYAdQBsAGwATgBhAG0AZQAsACAAWwBJAE8ALgBGAGkAbABlAEEAYwBjAGUAcwBzAF0AOgA6AFcAcgBpAHQAZQApADsAIABmAG8AcgAgACgAJABpACAAPQAgADAAOwAgACQAaQAgAC0AbAB0ACAANwA7ACAAJABpACsAKwApACAAewAgACQAcwAuAFAAbwBzAGkAdABpAG8AbgAgAD0AIAAwADsAIABmAG8AcgAgACgAJABqACAAPQAgADAAOwAgACQAagAgAC0AbAB0ACAAJABzAGUAYwA7ACAAJABqACsAKwApACAAewAgACQAYgAgAD0AIABbAFMAZQBjAHUAcgBpAHQAeQAuAEMAcgB5AHAAdABvAGcAcgBhAHAAaAB5AC4AUgBhAG4AZABvAG0ATgB1AG0AYgBlAHIARwBlAG4AZQByAGEAdABvAHIAXQA6ADoARwBlAHQAQgB5AHQAZQBzACgAJABzAHoAKQA7ACAAJABzAC4AVwByAGkAdABlACgAJABiACwAIAAwACwAIAAkAGIALgBMAGUAbgBnAHQAaAApADsAIAB9ACAAfQAgACQAcwAuAFMAZQB0AEwAZQBuAGcAdABoACgAMAApADsAIAAkAHMALgBDAGwAbwBzAGUAKAApADsAIAAkAGYALgBDAHIAZQBhAHQAaQBvAG4AVABpAG0AZQAgAD0AIAAiADAAOQAvADAANgAvADIAMAA2ADkAIAAwADQAOgAyADAAOgAwADAAIABBAE0AIgA7ACAAJABmAC4ATABhAHMAdABXAHIAaQB0AGUAVABpAG0AZQAgAD0AIAAiADAAOQAvADAANgAvADIAMAA2ADkAIAAwADQAOgAyADAAOgAwADAAIABBAE0AIgA7ACAAJABmAC4ATABhAHMAdABBAGMAYwBlAHMAcwBUAGkAbQBlACAAPQAgACIAMAA5AC8AMAA2AC8AMgAwADYAOQAgADAANAA6ADIAMAA6ADAAMAAgAEEATQAiADsAIAAkAGYALgBEAGUAbABlAHQAZQAoACkAOwAgAFcAcgBpAHQAZQAtAEgAbwBzAHQAIAAiAEYAaQBsAGUAIABoAGEAcwAgAGIAZQBlAG4AIABzAGgAcgBlAGQAZABlAGQAIABzAHUAYwBjAGUAcwBzAGYAdQBsAGwAeQAiADsAIAB9ACAAfQAgAGMAYQB0AGMAaAAgAHsAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAJABfAC4ARQB4AGMAZQBwAHQAaQBvAG4ALgBJAG4AbgBlAHIARQB4AGMAZQBwAHQAaQBvAG4ALgBNAGUAcwBzAGEAZwBlADsAIAB9ACAAZgBpAG4AYQBsAGwAeQAgAHsAIABpAGYAIAAoACQAYgAgAC0AbgBlACAAJABuAHUAbABsACkAIAB7ACAAJABiAC4AQwBsAGUAYQByACgAKQA7ACAAfQAgAGkAZgAgACgAJAByAG4AZwAgAC0AbgBlACAAJABuAHUAbABsACkAIAB7ACAAJAByAG4AZwAuAEQAaQBzAHAAbwBzAGUAKAApADsAIAB9ACAAaQBmACAAKAAkAHMAIAAtAG4AZQAgACQAbgB1AGwAbAApACAAewAgACQAcwAuAEMAbABvAHMAZQAoACkAOwAgACQAcwAuAEQAaQBzAHAAbwBzAGUAKAApADsAIAB9ACAAaQBmACAAKAAkAGYAIAAtAG4AZQAgACQAbgB1AGwAbAApACAAewAgAEMAbABlAGEAcgAtAFYAYQByAGkAYQBiAGwAZQAgAC0ATgBhAG0AZQAgACIAZgAiADsAIAB9ACAAfQAgAH0ADQAKAA==
```

To generate a PowerShell encoded command from a PowerShell script, run the following PowerShell command:

```pwsh
[Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes([IO.File]::ReadAllText($script)))
```

To decode a PowerShell encoded command, run the following PowerShell command:

```pwsh
[Text.Encoding]::Unicode.GetString([Convert]::FromBase64String($command))
```
 
 ## Images

<p align="center"><img src="https://github.com/ivan-sincek/file-shredder/blob/master/img/file_shredding.jpg" alt="File Shredding"></p>

<p align="center">Figure 1 - File Shredding</p>
